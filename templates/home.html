{% extends '_base.html' %}

{% block page_title %}خانه{% endblock page_title %}

{% block styles %}
<style>
    /* Full-page animated background (only in this view) */
  /* Subtle animated swirl background */
  .page-animated-bg { position: fixed; inset: 0; pointer-events: none; z-index: 0;
    background: radial-gradient(60% 40% at 90% 10%, rgba(13,110,253,.20), transparent 60%),
                radial-gradient(50% 30% at 10% 90%, rgba(102,16,242,.18), transparent 60%),
                conic-gradient(from 180deg at 50% 50%, rgba(13,110,253,.05), rgba(102,16,242,.05), rgba(13,110,253,.05));
    filter: blur(16px) saturate(1.05); transform: scale(1.2); animation: swirl 22s linear infinite; }
  @keyframes swirl { to { transform: scale(1.2) rotate(360deg); } }

  .page-content { position: relative; z-index: 1; }
  /* Hero */
  .hero {
    position: relative;
    border-radius: 1.25rem;
    background: radial-gradient(1200px 600px at 100% -10%, rgba(13,110,253,.12), transparent 60%),
                radial-gradient(800px 400px at 0% 110%, rgba(102,16,242,.10), transparent 60%),
                #fff;
    overflow: hidden;
  }
  .hero::after {
    content: "";
    position: absolute;
    inset: -20% -10% auto -10%;
    height: 60%;
    background: radial-gradient(closest-side, rgba(13,110,253,.08), transparent 60%);
    filter: blur(20px);
    pointer-events: none;
  }
  .gradient-text {
    background: linear-gradient(90deg, #0d6efd, #6610f2);
    -webkit-background-clip: text; background-clip: text;
    color: transparent;
  }
  .hero-cta .btn { padding-inline: 1rem; }
  .hero-illustration i { color: #0d6efd; filter: drop-shadow(0 6px 20px rgba(13,110,253,.25)); }

  /* Stats */
  .stat { text-align: center; padding: 1rem 0; }
  .stat .num { font-weight: 700; font-size: 1.5rem; }
  .stat .label { color: #6c757d; font-size: .9rem; }

  /* Features */
  .feature-card {
    background: #fff;
    border: 1px solid rgba(0,0,0,.06);
    border-radius: 1rem;
    padding: 1rem;
    height: 100%;
    transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;
  }
  .feature-card:hover { transform: translateY(-4px); box-shadow: 0 14px 40px rgba(0,0,0,.06); border-color: rgba(13,110,253,.25); }
  .feature-card i { color: #0d6efd; }

  /* Section header */
  .section-title { font-weight: 800; }
  .section-sub { color: #6c757d; }

  /* Animated Blogs Section */
  .blogs-section {
    position: relative;
    border-radius: 1.25rem;
    overflow: hidden;
    padding: 1.25rem;
    background: #f8f9fa;
  }
  .blogs-section .animated-bg {
    position: absolute;
    inset: -20% -10% -10% -10%;
    background: radial-gradient(60% 40% at 90% 10%, rgba(13,110,253,.25), transparent 60%),
                radial-gradient(50% 30% at 10% 90%, rgba(102,16,242,.22), transparent 60%),
                conic-gradient(from 180deg at 50% 50%, rgba(13,110,253,.06), rgba(102,16,242,.06), rgba(13,110,253,.06));
    filter: blur(14px) saturate(1.1);
    transform: scale(1.2);
    animation: swirl 18s linear infinite;
    z-index: 0;
  }
  @keyframes swirl { to { transform: scale(1.2) rotate(360deg); } }

  .blog-grid { position: relative; z-index: 1; }
  .blog-grid {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 1rem;
  }
  @media (max-width: 991.98px) { .blog-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
  @media (max-width: 575.98px) { .blog-grid { grid-template-columns: 1fr; } }

  .blog-card {
    position: relative;
    border-radius: 1rem;
    overflow: hidden;
    height: 320px;
    transform: translateZ(0);
    transition: transform .25s ease, box-shadow .25s ease;
    box-shadow: 0 8px 24px rgba(0,0,0,.06);
    border: 1px solid rgba(255,255,255,.25);
  }
  .blog-card:hover { transform: translateY(-6px); box-shadow: 0 18px 48px rgba(0,0,0,.10); }

  .blog-thumb {
    position: absolute; inset: 0; background-size: cover; background-position: center; filter: saturate(1.08);
    transition: transform .6s ease, filter .6s ease;
  }
  .blog-card:hover .blog-thumb { transform: scale(1.08); filter: saturate(1.15) contrast(1.02); }

  .blog-overlay {
    position: absolute; inset: 0;
    display: flex; align-items: flex-end; padding: 1rem;
    background: linear-gradient(to top, rgba(0,0,0,.55), rgba(0,0,0,.0) 55%);
  }

  .glass {
    width: 100%;
    background: rgba(255, 255, 255, 0.15);
    border: 1px solid rgba(255, 255, 255, 0.35);
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
    border-radius: .75rem;
    padding: .75rem;
    color: #fff;
    transform: translateY(4px);
    transition: transform .25s ease, background .25s ease, border-color .25s ease;
  }
  .blog-card:hover .glass { transform: translateY(-2px); background: rgba(255,255,255,.2); border-color: rgba(255,255,255,.55); }

  .glass h3 { font-size: 1.05rem; margin: 0 0 .25rem 0; }
  .glass p { font-size: .85rem; margin: 0 0 .5rem 0; color: rgba(255,255,255,.9); }
  .glass .meta { font-size: .75rem; opacity: .95; display: flex; gap: .75rem; flex-wrap: wrap; }
  .glass .meta i { opacity: .9; }

  @media (max-width: 991.98px) {
    .hero { text-align: center; }
    .hero-cta { justify-content: center; }
  }
</style>
{% endblock styles %}

{% block content %}

  <!-- Hero -->
  <section class="hero p-4 p-md-5 mb-5">
    <div class="row align-items-center g-4">
      <div class="col-12 col-lg-7">
        <h1 class="display-5 fw-bolder mb-3">
          به <span class="gradient-text">خَلَج</span> خوش آمدید
        </h1>
        <p class="text-muted mb-4">پلتفرمی ساده، سریع و لذت‌بخش برای نوشتن و خواندن. ایده‌های خود را با دنیا به اشتراک بگذارید.</p>
        <div class="d-flex gap-2 hero-cta flex-wrap">
          {% if user.is_authenticated %}
            <a href="{% url 'blog_create' %}" class="btn btn-primary"><i class="fa-solid fa-pen"></i> نوشتن پست جدید</a>
            <a href="{% url 'blog_list' %}" class="btn btn-outline-secondary">مشاهده بلاگ</a>
          {% else %}
            <a href="{% url 'signup' %}" class="btn btn-primary"><i class="fa-solid fa-user-plus"></i> شروع کنید</a>
            <a href="{% url 'blog_list' %}" class="btn btn-outline-secondary">مشاهده بلاگ</a>
          {% endif %}
        </div>
        <div class="row mt-4 g-3">
          <div class="col-4">
            <div class="stat"><div class="num">+۱K</div><div class="label">کاربر</div></div>
          </div>
          <div class="col-4">
            <div class="stat"><div class="num">+۵K</div><div class="label">پست</div></div>
          </div>
          <div class="col-4">
            <div class="stat"><div class="num">+۲۰K</div><div class="label">دیدگاه</div></div>
          </div>
        </div>
      </div>
      <div class="col-12 col-lg-5 hero-illustration text-center">
        <i class="fa-solid fa-feather-pointed fa-8x"></i>
      </div>
    </div>
  </section>

  <!-- Features -->
  <section class="mb-5">
    <div class="d-flex align-items-end justify-content-between flex-wrap gap-2 mb-3">
      <div>
        <h2 class="section-title h3 mb-1">چرا خَلَج؟</h2>
        <p class="section-sub mb-0">تمرکز بر سادگی، سرعت و تجربه‌ی دلنشین.</p>
      </div>
    </div>
    <div class="row g-3 g-md-4">
      <div class="col-12 col-md-4">
        <div class="feature-card h-100">
          <div class="d-flex align-items-center gap-2 mb-2"><i class="fa-solid fa-bolt"></i><strong>سریع و سبک</strong></div>
          <p class="text-muted small mb-0">طراحی بهینه برای بارگذاری سریع و تجربه روان روی همه دستگاه‌ها.</p>
        </div>
      </div>
      <div class="col-12 col-md-4">
        <div class="feature-card h-100">
          <div class="d-flex align-items-center gap-2 mb-2"><i class="fa-solid fa-shield-heart"></i><strong>امن و قابل اعتماد</strong></div>
          <p class="text-muted small mb-0">استانداردهای مدرن برای حفاظت از حساب و محتوای شما.</p>
        </div>
      </div>
      <div class="col-12 col-md-4">
        <div class="feature-card h-100">
          <div class="d-flex align-items-center gap-2 mb-2"><i class="fa-solid fa-mobile-screen"></i><strong>کاملاً ریسپانسیو</strong></div>
          <p class="text-muted small mb-0">نمایش عالی در موبایل، تبلت و دسکتاپ با RTL کامل.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Callout to Blog -->
  <section class="mb-4">
    <div class="p-4 p-md-5 rounded-4 border bg-light d-flex flex-column flex-md-row align-items-center justify-content-between gap-3">
      <div>
        <h3 class="h4 fw-bold mb-2">از همین حالا شروع به خواندن کنید</h3>
        <p class="text-muted mb-0">جدیدترین نوشته‌ها و موضوعات جذاب در دسترس شماست.</p>
      </div>
      <a href="{% url 'blog_list' %}" class="btn btn-dark">رفتن به بلاگ</a>
    </div>
  </section>

  <!-- Latest Blogs (glass cards on animated bg) -->
  <section class="blogs-section mb-5">
    <div class="animated-bg"></div>
    <div class="d-flex align-items-end justify-content-between flex-wrap gap-2 mb-3 position-relative" style="z-index:1;">
      <div>
        <h2 class="section-title h4 mb-1">O�O_UOO_U� O"U,OU_</h2>
        <p class="section-sub mb-0">O3O�O3 O"U�U�O"U� U^ O_U+UOO U.O-O�U^OUO U� U^U�O_U?</p>
      </div>
      <a href="{% url 'blog_list' %}" class="btn btn-outline-dark btn-sm">U.O'OU�O_U� O_O�</a>
    </div>

    <div class="blog-grid">
      {% if latest_blogs %}
        {% for item in latest_blogs %}
          <a class="text-decoration-none" href="{% url 'blog_detail' item.pk %}">
            <article class="blog-card">
              <div class="blog-thumb" style="background-image:url('{{ item.cover.url }}');"></div>
              <div class="blog-overlay">
                <div class="glass">
                  <h3 class="fw-bold">{{ item.title }}</h3>
                  <p>{{ item.description|truncatechars:120 }}</p>
                  <div class="meta">
                    <span><i class="fa-regular fa-user"></i> {{ item.author }}</span>
                    <span><i class="fa-regular fa-clock"></i> {{ item.created_at|date:"Y/m/d" }}</span>
                    <span><i class="fa-regular fa-eye"></i> {{ item.views }}</span>
                    <span><i class="fa-regular fa-heart"></i> {{ item.total_likes }}</span>
                  </div>
                </div>
              </div>
            </article>
          </a>
        {% endfor %}
      {% else %}
        {% for _ in "123" %}
          <a class="text-decoration-none" href="{% url 'blog_list' %}">
            <article class="blog-card">
              <div class="blog-thumb" style="background-image:linear-gradient(135deg,#dfe9ff,#f5e9ff);"></div>
              <div class="blog-overlay">
                <div class="glass">
                  <h3 class="fw-bold">O�U?O�U+ O"U� O"U,OU_</h3>
                  <p>O�O_UOO_O�O�UOU+ U+U^O'O�U؃?OU�O U^ U.U^OU^O1OO� O�O�OO".</p>
                  <div class="meta">
                    <span><i class="fa-regular fa-arrow-left"></i> O�U?O�U+</span>
                  </div>
                </div>
              </div>
            </article>
          </a>
        {% endfor %}
      {% endif %}
    </div>
  </section>

{% endblock content %}
